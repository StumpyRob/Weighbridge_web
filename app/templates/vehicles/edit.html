{% extends "base.html" %}

{% block title %}Edit Vehicle {{ vehicle.registration }} | Weighbridge Web{% endblock %}

{% block content %}
<div class="page-header">
  <div>
    <h1>{{ vehicle.registration }}</h1>
    <p class="muted">Edit vehicle details.</p>
  </div>
</div>

{% if errors %}
  <div class="alert">
    <ul>
      {% for error in errors %}
        <li>{{ error }}</li>
      {% endfor %}
    </ul>
  </div>
{% endif %}

<form class="ticket-form" method="post" action="/vehicles/{{ vehicle.id }}">
  {% include "vehicles/_form.html" %}
  <div class="actions">
    <button type="submit">Save</button>
    <a class="link-button" href="/vehicles">Cancel</a>
  </div>
</form>

<section class="card">
  <h2>Per-Container Tares</h2>
  <form class="inline-form" method="post" action="/vehicles/{{ vehicle.id }}/tares">
    <select name="container_id">
      <option value="">Select container</option>
      {% for id, label in options.containers %}
        <option value="{{ id }}">{{ label }}</option>
      {% endfor %}
    </select>
    <input type="number" step="0.001" name="tare_kg" placeholder="Tare kg" />
    <button type="submit">Add/Update</button>
  </form>

  <div class="table-wrap">
    <table class="data-table">
      <thead>
        <tr>
          <th>Container</th>
          <th>Tare (kg)</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for tare, container in tares %}
          <tr>
            <td>{{ container.name }}</td>
            <td>
              <form class="inline-form" method="post" action="/vehicles/{{ vehicle.id }}/tares/{{ tare.id }}/update">
                <input type="number" step="0.001" name="tare_kg" value="{{ tare.tare_kg }}" />
                <button type="submit">Save</button>
              </form>
            </td>
            <td>
              <form method="post" action="/vehicles/{{ vehicle.id }}/tares/{{ tare.id }}/delete">
                <button type="submit" class="danger">Delete</button>
              </form>
            </td>
          </tr>
        {% else %}
          <tr>
            <td colspan="3" class="empty">No per-container tares.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</section>
{% endblock %}
